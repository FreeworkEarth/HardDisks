LAMMPS (22 Jul 2025 - Update 1)
# Simplified LAMMPS test for 2D hard disk with movable wall
units           lj
dimension       2
atom_style      atomic
atom_modify     map yes
boundary        f f p

# Box
region          box block -10 10 -5 5 -0.5 0.5
create_box      2 box
Created orthogonal box = (-10 -5 -0.5) to (10 5 0.5)
  1 by 1 by 1 MPI processor grid

# Particles on lattice (more controlled)
lattice         sq 0.5  # 2D square lattice, spacing 0.5
Lattice spacing in x,y,z = 1.4142136 1.4142136 1.4142136
region          left_fill block -9 -1 -4 4 -0.5 0.5
region          right_fill block 1 9 -4 4 -0.5 0.5
create_atoms    1 region left_fill
Created 49 atoms
  using lattice units in orthogonal box = (-10 -5 -0.5) to (10 5 0.5)
  create_atoms CPU = 0.000 seconds
create_atoms    1 region right_fill
Created 49 atoms
  using lattice units in orthogonal box = (-10 -5 -0.5) to (10 5 0.5)
  create_atoms CPU = 0.000 seconds

# Wall at center
create_atoms    2 single 0 0 0
Created 1 atoms
  using lattice units in orthogonal box = (-10 -5 -0.5) to (10 5 0.5)
  create_atoms CPU = 0.000 seconds

mass            1 1.0
mass            2 50.0

group           particles type 1
98 atoms in group particles
group           wall_atom type 2
1 atoms in group wall_atom

# Soft WCA potential with smaller epsilon for stability
pair_style      lj/cut 1.122462
pair_modify     shift yes
pair_coeff      1 1 0.1 1.0 1.122462  # Softer epsilon=0.1
pair_coeff      1 2 0.1 1.0 1.122462
pair_coeff      2 2 0.0 1.0 1.122462

# Walls
fix             walls_y particles wall/reflect yhi EDGE ylo EDGE
fix             walls_x particles wall/reflect xhi EDGE xlo EDGE

# Initialize velocities (lower temperature)
velocity        particles create 0.1 12345
velocity        wall_atom set 0 0 0
fix             wall_yz wall_atom setforce NULL 0 0

# Integration with smaller timestep
timestep        0.0001
fix             1 particles nve
fix             2 wall_atom nve

# Output
thermo          100
thermo_style    custom step temp ke atoms

# Test run
run             1000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 1.422462
  ghost atom cutoff = 1.422462
  binsize = 0.711231, bins = 29 15 2
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 3.038 | 3.038 | 3.038 Mbytes
   Step          Temp          KinEng        Atoms   
         0   0.098979592    0.097979798           99 
       100   0.098979592    0.097979798           99 
       200   0.098979592    0.097979798           99 
       300   0.098979592    0.097979798           99 
       400   0.098979592    0.097979798           99 
       500   0.098979592    0.097979798           99 
       600   0.098979592    0.097979798           99 
       700   0.098979592    0.097979798           99 
       800   0.098979592    0.097979798           99 
       900   0.098979592    0.097979798           99 
      1000   0.098979592    0.097979798           99 
Loop time of 0.00172104 on 1 procs for 1000 steps with 99 atoms

Performance: 5020217.415 tau/day, 581043.682 timesteps/s, 57.523 Matom-step/s
99.7% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.00045126 | 0.00045126 | 0.00045126 |   0.0 | 26.22
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 4.2617e-05 | 4.2617e-05 | 4.2617e-05 |   0.0 |  2.48
Output  | 6.876e-06  | 6.876e-06  | 6.876e-06  |   0.0 |  0.40
Modify  | 0.0010419  | 0.0010419  | 0.0010419  |   0.0 | 60.54
Other   |            | 0.0001784  |            |       | 10.36

Nlocal:             99 ave          99 max          99 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:            170 ave         170 max         170 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 170
Ave neighs/atom = 1.7171717
Neighbor list builds = 0
Dangerous builds = 0

print           "Test successful!"
Test successful!
Total wall time: 0:00:00
